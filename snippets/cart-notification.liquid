{% comment %}
  Cart Notification Drawer
{% endcomment %}

<div id="cart-notification" class="cart-notification" style="display: none; position: fixed; top: 0; right: 0; width: 100%; max-width: 400px; height: 100%; background: #000; z-index: 10000; box-shadow: -2px 0 10px rgba(0,0,0,0.5); overflow-y: auto;">
  <div class="cart-notification-header" style="padding: 20px; border-bottom: 1px solid #1a1a1a; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; background: #000;">
    <h2 style="color: #fff; font-size: 18px; font-weight: 300; text-transform: uppercase; letter-spacing: 2px; margin: 0;">
      Cart
    </h2>
    <button class="cart-notification-close" style="background: none; border: none; color: #fff; font-size: 24px; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
  </div>

  <div class="cart-notification-content" style="padding: 20px;">
    <div id="cart-notification-items">
      {% if cart.item_count > 0 %}
        {% for item in cart.items %}
          <div class="cart-notification-item" style="display: flex; gap: 15px; padding: 20px 0; border-bottom: 1px solid #1a1a1a;">
            <div class="item-image" style="width: 80px; height: 80px; background: #1a1a1a; flex-shrink: 0;">
              <img src="{{ item.image | img_url: '200x200' }}" 
                   alt="{{ item.title }}"
                   style="width: 100%; height: 100%; object-fit: cover;">
            </div>
            <div class="item-details" style="flex: 1;">
              <h3 style="color: #fff; font-size: 14px; font-weight: 400; margin: 0 0 5px; text-transform: uppercase; letter-spacing: 0.5px;">
                {{ item.product.title }}
              </h3>
              <p style="color: #888; font-size: 12px; margin: 0 0 10px;">
                {{ item.variant.title }}
              </p>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color: #e0e0e0; font-size: 14px;">
                  {{ item.final_line_price | money }}
                </span>
                <span style="color: #888; font-size: 12px;">
                  Qty: {{ item.quantity }}
                </span>
              </div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p style="color: #888; text-align: center; padding: 40px 0;">
          Your cart is empty
        </p>
      {% endif %}
    </div>

    {% if cart.item_count > 0 %}
      <div class="cart-notification-footer" style="margin-top: 30px; padding-top: 30px; border-top: 1px solid #1a1a1a;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
          <span style="color: #888; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">Total</span>
          <span style="color: #fff; font-size: 20px; font-weight: 500;">{{ cart.total_price | money }}</span>
        </div>
        <a href="{{ routes.cart_url }}" 
           style="display: block; padding: 15px; background: #fff; color: #000; text-align: center; text-decoration: none; text-transform: uppercase; letter-spacing: 2px; font-size: 14px; margin-bottom: 15px; transition: all 0.3s;">
          View Cart
        </a>
        <a href="{{ routes.cart_url }}" 
           style="display: block; padding: 15px; background: transparent; border: 2px solid #fff; color: #fff; text-align: center; text-decoration: none; text-transform: uppercase; letter-spacing: 2px; font-size: 14px; transition: all 0.3s;">
          Checkout
        </a>
      </div>
    {% endif %}
  </div>
</div>

<div id="cart-notification-overlay" class="cart-notification-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999;"></div>

<style>
  .cart-notification.active {
    display: block !important;
  }
  
  .cart-notification-overlay.active {
    display: block !important;
  }
  
  .cart-notification a:hover {
    opacity: 0.8;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const cartNotification = document.getElementById('cart-notification');
    const cartOverlay = document.getElementById('cart-notification-overlay');
    const closeBtn = document.querySelector('.cart-notification-close');
    
    function openCart() {
      if (cartNotification) cartNotification.classList.add('active');
      if (cartOverlay) cartOverlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    function closeCart() {
      if (cartNotification) cartNotification.classList.remove('active');
      if (cartOverlay) cartOverlay.classList.remove('active');
      document.body.style.overflow = '';
    }
    
    if (closeBtn) {
      closeBtn.addEventListener('click', closeCart);
    }
    
    if (cartOverlay) {
      cartOverlay.addEventListener('click', closeCart);
    }
    
    // Listen for cart updates
    document.addEventListener('cart:updated', function() {
      // Reload cart notification content
      location.reload();
    });
  });
</script>

