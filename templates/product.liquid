{% comment %}
  Product Template - Based on Figma Design
{% endcomment %}

<div class="product-page" style="background-color: #050505; padding: 60px 20px; min-height: 80vh;">
  <div class="page-width">
    <div class="product-container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 80px; max-width: 1400px; margin: 0 auto;">
      
      {% comment %} Product Images - Left Side {% endcomment %}
      <div class="product-images">
        {% if product.featured_image %}
          <div class="main-image" style="margin-bottom: 20px; background: #141414; border-radius: 10px; overflow: hidden; aspect-ratio: 0.96;">
            <img src="{{ product.featured_image | img_url: '1200x1200' }}" 
                 alt="{{ product.title }}"
                 style="width: 100%; height: 100%; object-fit: cover;">
          </div>
        {% endif %}
        
        {% if product.images.size > 1 %}
          <div class="thumbnail-images" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
            {% for image in product.images limit: 6 %}
              <div style="aspect-ratio: 0.86; background: #141414; border-radius: 10px; overflow: hidden; cursor: pointer; border: 1px solid rgba(255,255,255,0.05);">
                <img src="{{ image | img_url: '400x400' }}" 
                     alt="{{ image.alt }}"
                     style="width: 100%; height: 100%; object-fit: cover;">
              </div>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      {% comment %} Product Info - Right Side {% endcomment %}
      <div class="product-info">
        <h1 style="color: #D2D2D2; font-size: 48px; font-weight: 300; margin: 0 0 30px; text-transform: uppercase; letter-spacing: 3px; line-height: 1.2;">
          {{ product.title }}
        </h1>
        
        <div class="product-price" style="color: #D2D2D2; font-size: 32px; font-weight: 300; margin-bottom: 40px;">
          {% if product.compare_at_price > product.price %}
            <span style="text-decoration: line-through; color: #767676; margin-right: 15px; font-size: 24px;">
              {{ product.compare_at_price | money }}
            </span>
          {% endif %}
          <span>{{ product.price | money }}</span>
        </div>

        <div class="product-description" style="color: #767676; font-size: 16px; line-height: 1.8; margin-bottom: 50px;">
          {{ product.description }}
        </div>

        <form action="{{ routes.cart_add_url }}" method="post" enctype="multipart/form-data">
          {% unless product.has_only_default_variant %}
            <div class="product-variants" style="margin-bottom: 40px;">
              {% for option in product.options_with_values %}
                <div style="margin-bottom: 30px;">
                  <label style="display: block; color: #D2D2D2; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 15px;">
                    {{ option.name }}
                  </label>
                  <div style="display: flex; flex-wrap: wrap; gap: 15px;">
                    {% for value in option.values %}
                      <button type="button" 
                              class="variant-option-btn"
                              data-option="{{ option.name }}"
                              data-value="{{ value }}"
                              style="padding: 12px 24px; background: rgba(255,255,255,0.05); border: 1px solid rgba(113,113,113,0.4); border-radius: 24.5px; color: #D2D2D2; font-size: 14px; cursor: pointer; transition: all 0.3s; text-transform: uppercase; letter-spacing: 1px;">
                        {{ value }}
                      </button>
                    {% endfor %}
                  </div>
                  <select name="id" 
                          class="variant-select"
                          style="display: none;">
                    {% for variant in product.variants %}
                      <option value="{{ variant.id }}" {% if variant == product.selected_or_first_available_variant %}selected{% endif %}>
                        {{ variant.title }}
                      </option>
                    {% endfor %}
                  </select>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
          {% endunless %}

          <div style="display: flex; gap: 20px; margin-bottom: 50px; align-items: center;">
            <div style="display: flex; align-items: center; gap: 10px; border: 1px solid rgba(113,113,113,0.4); border-radius: 24.5px; padding: 8px 15px; background: rgba(255,255,255,0.05);">
              <button type="button" 
                      class="quantity-decrease"
                      style="width: 30px; height: 30px; background: none; border: none; color: #767676; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center;">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M3 6h6"/>
                </svg>
              </button>
              <input type="number" 
                     name="quantity" 
                     value="1" 
                     min="1"
                     class="quantity-input"
                     style="width: 50px; background: none; border: none; color: #D2D2D2; text-align: center; font-size: 16px; padding: 0;">
              <button type="button" 
                      class="quantity-increase"
                      style="width: 30px; height: 30px; background: none; border: none; color: #767676; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center;">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M6 3v6M3 6h6"/>
                </svg>
              </button>
            </div>
            <button type="submit" 
                    style="flex: 1; padding: 15px 40px; background: #fff; border: none; color: #000; text-transform: uppercase; letter-spacing: 2px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s; border-radius: 25px;">
              Add to Cart
            </button>
          </div>
        </form>

        {% if product.metafields.custom.product_details %}
          <div class="product-details" style="margin-top: 60px; padding-top: 40px; border-top: 1px solid rgba(125,125,125,0.5);">
            <h3 style="color: #D2D2D2; font-size: 18px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 20px; font-weight: 300;">
              Product Details
            </h3>
            <div style="color: #767676; font-size: 14px; line-height: 1.8;">
              {{ product.metafields.custom.product_details }}
            </div>
          </div>
        {% endif %}
      </div>

    </div>

    {% comment %} Related Products Section {% endcomment %}
    {% if collection.products.size > 1 %}
      <div class="related-products" style="margin-top: 100px; padding-top: 60px; border-top: 1px solid rgba(125,125,125,0.5);">
        <h2 style="color: #D2D2D2; font-size: 36px; font-weight: 300; text-transform: uppercase; letter-spacing: 3px; margin: 0 0 50px; text-align: center;">
          Related Products
        </h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 40px; max-width: 1400px; margin: 0 auto;">
          {% for related_product in collection.products limit: 4 %}
            {% unless related_product.id == product.id %}
              <a href="{{ related_product.url }}" style="text-decoration: none; color: inherit;">
                <div style="background: #141414; border-radius: 10px; overflow: hidden; aspect-ratio: 0.96;">
                  {% if related_product.featured_image %}
                    <img src="{{ related_product.featured_image | img_url: '600x600' }}" 
                         alt="{{ related_product.title }}"
                         style="width: 100%; height: 100%; object-fit: cover;">
                  {% endif %}
                </div>
                <h3 style="color: #D2D2D2; font-size: 16px; font-weight: 300; margin: 20px 0 10px; text-transform: uppercase; letter-spacing: 1px;">
                  {{ related_product.title }}
                </h3>
                <div style="color: #767676; font-size: 18px;">
                  {{ related_product.price | money }}
                </div>
              </a>
            {% endunless %}
          {% endfor %}
        </div>
      </div>
    {% endif %}
  </div>
</div>

<style>
  .product-page button[type="submit"]:hover {
    background: #D2D2D2 !important;
  }
  
  .variant-option-btn.active {
    background: #fff !important;
    color: #000 !important;
    border-color: #fff !important;
  }
  
  .quantity-decrease:hover,
  .quantity-increase:hover {
    color: #D2D2D2 !important;
  }
  
  @media (max-width: 1024px) {
    .product-container {
      grid-template-columns: 1fr !important;
      gap: 40px !important;
    }
    .product-info h1 {
      font-size: 36px !important;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Variant selection
    const variantButtons = document.querySelectorAll('.variant-option-btn');
    const variantSelect = document.querySelector('.variant-select');
    
    variantButtons.forEach(button => {
      button.addEventListener('click', function() {
        const optionName = this.dataset.option;
        const value = this.dataset.value;
        
        // Remove active class from siblings
        const siblings = document.querySelectorAll(`[data-option="${optionName}"]`);
        siblings.forEach(sib => sib.classList.remove('active'));
        
        // Add active to clicked
        this.classList.add('active');
        
        // Update variant select
        if (variantSelect) {
          const options = variantSelect.querySelectorAll('option');
          options.forEach(opt => {
            if (opt.textContent.includes(value)) {
              opt.selected = true;
            }
          });
        }
      });
    });
    
    // Set initial active variant
    if (variantButtons.length > 0) {
      variantButtons[0].classList.add('active');
    }
    
    // Quantity controls
    const qtyDecrease = document.querySelector('.quantity-decrease');
    const qtyIncrease = document.querySelector('.quantity-increase');
    const qtyInput = document.querySelector('.quantity-input');
    
    if (qtyDecrease && qtyInput) {
      qtyDecrease.addEventListener('click', function() {
        if (parseInt(qtyInput.value) > 1) {
          qtyInput.value = parseInt(qtyInput.value) - 1;
        }
      });
    }
    
    if (qtyIncrease && qtyInput) {
      qtyIncrease.addEventListener('click', function() {
        qtyInput.value = parseInt(qtyInput.value) + 1;
      });
    }
  });
</script>

